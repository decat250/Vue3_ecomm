{"remainingRequest":"/Users/decat/Vue3_ecomm/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/decat/Vue3_ecomm/src/views/adm/product.vue?vue&type=style&index=0&id=2f664360&lang=css","dependencies":[{"path":"/Users/decat/Vue3_ecomm/src/views/adm/product.vue","mtime":1648372643110},{"path":"/Users/decat/Vue3_ecomm/node_modules/css-loader/dist/cjs.js","mtime":1645696104439},{"path":"/Users/decat/Vue3_ecomm/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1645696107320},{"path":"/Users/decat/Vue3_ecomm/node_modules/postcss-loader/src/index.js","mtime":1645696106356},{"path":"/Users/decat/Vue3_ecomm/node_modules/cache-loader/dist/cjs.js","mtime":1645696104150},{"path":"/Users/decat/Vue3_ecomm/node_modules/vue-loader-v16/dist/index.js","mtime":1645696107319}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50ZXN0aW1vbmlhbC1ncm91cCA+IC5yb3cgewogIGRpc3BsYXk6IGJsb2NrOwogIG92ZXJmbG93LXg6IGF1dG87CiAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKfQoudGVzdGltb25pYWwtZ3JvdXAgPiAucm93ID4gLmNvbC00IHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0KLmJ0bi1maWxlIGlucHV0W3R5cGU9ImZpbGUiXSB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMDsKICByaWdodDogMDsKICBtaW4td2lkdGg6IDEwMCU7CiAgbWluLWhlaWdodDogMTAwJTsKICBmb250LXNpemU6IDEwMHB4OwogIHRleHQtYWxpZ246IHJpZ2h0OwogIGZpbHRlcjogYWxwaGEob3BhY2l0eT0wKTsKICBvcGFjaXR5OiAwOwogIG91dGxpbmU6IG5vbmU7CiAgYmFja2dyb3VuZDogd2hpdGU7CiAgY3Vyc29yOiBpbmhlcml0OwogIGRpc3BsYXk6IGJsb2NrOwp9Cg=="},{"version":3,"sources":["/Users/decat/Vue3_ecomm/src/views/adm/product.vue"],"names":[],"mappings":";AAiMA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE;EACxB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACrB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACjC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACvB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,EAAE,CAAC;EACN,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACxB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AAChB","file":"/Users/decat/Vue3_ecomm/src/views/adm/product.vue","sourceRoot":"","sourcesContent":["<template>\n  商品管理\n  <n-button\n    type=\"primary\"\n    @click=\"\n      showModal = true;\n      mod: 0;\n    \"\n  >\n    新增商品\n  </n-button>\n  <vue-good-table\n    ref=\"my-table\"\n    :search-options=\"{ enabled: true }\"\n    :columns=\"columns\"\n    :rows=\"rows\"\n    :paginate=\"true\"\n    :lineNumbers=\"true\"\n    :globalSearch=\"true\"\n    :pagination-options=\"{\n      enabled: true,\n      mode: 'records',\n      perPage: 20,\n      position: 'top',\n      perPageDropdown: [5, 10, 20],\n      dropdownAllowAll: false,\n      setCurrentPage: 2,\n      jumpFirstOrLast: true,\n      firstLabel: '第一頁',\n      lastLabel: '最後一頁',\n      nextLabel: '下一頁',\n      prevLabel: '上一頁',\n      rowsPerPageLabel: '每頁顯示項目',\n      ofLabel: 'of',\n      pageLabel: 'page',\n      allLabel: 'All',\n      infoFn: (params) => `目前頁數 ${params.firstRecordOnPage}`,\n    }\"\n    @on-selected-rows-change=\"selectionChanged\"\n    :select-options=\"{\n      enabled: true,\n    }\"\n  >\n    >\n    <template #selected-row-actions>\n      <n-button type=\"primary\" style=\"margin-right: 10px\" v-on:click=\"test\">\n        刪除所選商品\n      </n-button>\n    </template>\n\n    <template #table-row=\"props\">\n      <span v-if=\"props.column.field == 'edit'\">\n        <n-button\n          type=\"primary\"\n          style=\"margin-right: 10px\"\n          v-on:click=\"edit(props.row.id)\"\n        >\n          編輯商品\n        </n-button>\n        <n-button type=\"primary\" v-on:click=\"del(props.row.id)\">\n          刪除\n        </n-button>\n      </span>\n      <span v-else>\n        {{ props.formattedRow[props.column.field] }}\n      </span>\n    </template>\n  </vue-good-table>\n  <n-button\n    id=\"deletebtn\"\n    style=\"display: None\"\n    @click=\"showDeleteModalRef = true\"\n  ></n-button>\n  <n-modal v-model:show=\"showModal\">\n    <n-card\n      style=\"width: 600px\"\n      title=\"Modal\"\n      :bordered=\"false\"\n      size=\"huge\"\n      role=\"dialog\"\n      aria-modal=\"true\"\n    >\n      <n-form :model=\"model\" ref=\"formRef\" :rules=\"rules\">\n        <n-form-item path=\"\" label=\"商品名稱\">\n          <n-input\n            placeholder=\"請輸入商品名稱\"\n            clearable\n            v-model:value=\"product_name\"\n            type=\"\"\n          />\n        </n-form-item>\n\n        <n-dynamic-input\n          v-model:value=\"opt\"\n          :on-create=\"onCreate\"\n          style=\"margin-top: 20px\"\n        >\n          <template #create-button-default> Add whatever you want </template>\n          <template #default=\"{ value }\">\n            <div style=\"display: flex; align-items: center; width: 100%\">\n              \n              <n-input-number\n                placeholder=\"輸入價格\"\n                v-model:value=\"value.price\"\n                style=\"margin-right: 12px; width: 180px\"\n                min=1\n              >\n                <template #prefix> $ </template>\n              </n-input-number>\n        \n              <n-input\n                placeholder=\"輸入規格\"\n                v-model:value=\"value.string\"\n                type=\"text\"\n                style=\"margin-right: 12px; width: 180px\"\n                \n              />\n            </div>\n          </template>\n        </n-dynamic-input>\n        <hr />\n        照片上傳<br />\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          multiple\n          @change=\"previewMultiImage\"\n          class=\"form-control-file\"\n          id=\"my-file\"\n          ref=\"fileInput\"\n          style=\"display: none\"\n        />\n        <n-button\n          type=\"primary\"\n          onclick=\"document.getElementById('my-file').click();\"\n          >瀏覽檔案\n        </n-button>\n\n        <div class=\"container testimonial-group\" style=\"margin-top: 10px\">\n          <div class=\"row text-center\">\n            <div\n              class=\"col-4\"\n              v-for=\"(item, index) in preview_list\"\n              :key=\"index\"\n            >\n              <img\n                :src=\"item\"\n                class=\"img-fluid\"\n                v-on:click=\"clicking($event)\"\n                style=\"max-width: 100px\"\n              />\n              <br />\n              <n-button type=\"error\" v-on:click=\"deleteimg(index)\">\n                刪除\n              </n-button>\n            </div>\n          </div>\n        </div>\n\n        <hr />\n        商品描述\n        <vue-editor v-model=\"product_describe\" />\n\n        <n-button type=\"primary\" @click=\"newproduct()\" block secondary strong\n          >新增商品\n        </n-button>\n\n        <n-modal\n          v-model:show=\"showpicModal\"\n          preset=\"card\"\n          style=\"width: 600px\"\n          title=\"\"\n        >\n          <img :src=\"previewImageUrl\" style=\"width: 100%\" />\n        </n-modal>\n      </n-form>\n    </n-card>\n  </n-modal>\n\n  <n-modal\n    v-model:show=\"showDeleteModalRef\"\n    :mask-closable=\"false\"\n    preset=\"dialog\"\n    title=\"確認視窗\"\n    content=\"您確定要刪除嗎?\"\n    positive-text=\"確定刪除\"\n    negative-text=\"取消\"\n    @positive-click=\"onPositiveClick\"\n    @negative-click=\"onNegativeClick\"\n    transform-origin=\"center\"\n  />\n</template>\n<style>\n.testimonial-group > .row {\n  display: block;\n  overflow-x: auto;\n  white-space: nowrap;\n}\n.testimonial-group > .row > .col-4 {\n  display: inline-block;\n}\n.btn-file input[type=\"file\"] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  min-width: 100%;\n  min-height: 100%;\n  font-size: 100px;\n  text-align: right;\n  filter: alpha(opacity=0);\n  opacity: 0;\n  outline: none;\n  background: white;\n  cursor: inherit;\n  display: block;\n}\n</style>\n<script>\nimport { defineComponent, ref } from \"vue\";\nimport { VueEditor } from \"vue3-editor\";\nimport axios from \"axios\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"jquery/dist/jquery.min.js\";\n//import $ from \"jquery\";\nimport { VueGoodTable } from \"vue-good-table-next\";\nimport \"vue-good-table-next/dist/vue-good-table-next.css\";\n\nexport default defineComponent({\n  components: { VueEditor, VueGoodTable },\n\n  setup() {\n    const formRef = ref(null);\n    const rPasswordFormItemRef = ref(null);\n    const modelRef = ref({});\n\n    return {\n      opt: ref([\n        {\n          price: \"\",\n          string: \"\",\n        },\n      ]),\n      onCreate() {\n        return {\n          price: \"\",\n          string: \"\",\n        };\n      },\n      showModal: ref(false),\n      showDeleteModalRef: ref(false),\n      pagination: { pageSize: 10 },\n      formRef,\n      rPasswordFormItemRef,\n      model: modelRef,\n      rules: {},\n    };\n  },\n  data() {\n    return {\n      preview: \"\",\n      image_list: [],\n      preview_list: [],\n      product_name: \"1\",\n      product_describe: \"\",\n      editid: 0,\n      mod: 0, //0 新增 1 修改\n      columns: [\n        {\n          label: \"名稱\",\n          field: \"name\",\n        },\n        {\n          label: \"價格\",\n          field: \"price\",\n          type: \"number\",\n        },\n        {\n          label: \"編輯商品\",\n          field: \"edit\",\n        },\n      ],\n      rows: [],\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    test() {\n      console.log(this.$refs[\"my-table\"].selectedRows);\n    },\n    load() {\n      axios.get(\"http://localhost/api/productadmgetlist\", {}).then((res) => {\n        this.rows = res.data.data;\n      });\n    },\n    del(id) {\n      document.getElementById(\"deletebtn\").click();\n      this.editid = id;\n    },\n    edit(id) {\n      this.image_list = [];\n      this.preview_list = [];\n      this.product_name = \"\";\n      this.product_describe = \"\";\n      this.product_price = 0;\n      this.showModal = true;\n      this.mod = 1;\n      axios.get(\"http://127.0.0.1/api/getproductinfo/\" + id, {}).then((res) => {\n        console.log(res.data.productdata.opt)\n        this.product_name = res.data.productdata.product_name;\n        this.product_describe = res.data.productdata.product_describe;\n        this.opt = res.data.productdata.optad;\n        this.editid = id;\n        for (var i = 0; i < res.data.productdata.product_img.length; i++) {\n          this.getfileimg(res.data.productdata.product_img[i].src);\n        }\n      });\n    },\n\n    onPositiveClick() {\n      const formData = new FormData();\n      formData.append(\"deleteid\", this.editid);\n      axios\n        .post(\"http://localhost/api/delproduct\", formData, {})\n        .then((res) => {\n          if (res.data.Status == \"Success\") {\n            window.$message.success(res.data.Message);\n\n            this.showDeleteModalRef = false;\n          }\n        });\n      this.load();\n      axios.get(\"http://localhost/api/productadmgetlist\", {}).then((res) => {\n        this.rows = res.data.data;\n      });\n    },\n    onNegativeClick() {\n      this.showDeleteModalRef = false;\n    },\n\n    deleteimg(index) {\n      this.preview_list.splice(index, 1);\n      this.image_list.splice(index, 1);\n    },\n    previewMultiImage: function (event) {\n      var input = event.target;\n      var count = input.files.length;\n      var index = 0;\n\n      if (input.files) {\n        while (count--) {\n          var reader = new FileReader();\n          reader.onload = (e) => {\n            this.preview_list.push(e.target.result);\n          };\n          this.image_list.push(input.files[index]);\n          reader.readAsDataURL(input.files[index]);\n          index++;\n        }\n      }\n    },\n    getfileimg(url) {\n      //編輯商品仔入相片\n      fetch(url, { mode: \"cors\" })\n        .then((res) => res.blob())\n        .then((blob) => {\n          const file = new File([blob], \"url.jpg\", { type: \"image/png\" });\n          this.image_list.push(file);\n\n          var fr = new FileReader();\n          fr.onload = (e) => {\n            this.preview_list.push(e.target.result);\n          };\n          fr.readAsDataURL(blob);\n        });\n    },\n    newproduct() {\n      const formData = new FormData();\n\n      for (var i = 0; i < this.image_list.length; i++) {\n        console.log(this.image_list[i]);\n        formData.append(\"file[]\", this.image_list[i]);\n      }\n    \n      formData.append(\"id\", this.editid);\n      formData.append(\"opt\", JSON.stringify(this.opt));\n      formData.append(\"product_name\", this.product_name);\n      formData.append(\"product_describe\", this.product_describe);\n      if (this.mod == 0) {\n        axios\n          .post(\"http://localhost/api/newproduct\", formData, {})\n          .then((res) => {\n            if (res.data.Status == \"Success\") {\n              this.showModal = false;\n              this.image_list = [];\n              this.preview_list = [];\n              this.product_count = 0;\n              this.product_name = \"\";\n              this.product_describe = \"\";\n              this.product_img = [];\n              window.$message.success(res.data.Message);\n              axios\n                .get(\"http://localhost/api/productadmgetlist\", {})\n                .then((res) => {\n                  this.rows = res.data.data;\n                });\n            }\n          });\n      } else {\n        axios\n          .post(\"http://localhost/api/editproduct\", formData, {})\n          .then((res) => {\n            if (res.data.Status == \"Success\") {\n              this.showModal = false;\n              window.$message.success(res.data.Message);\n              axios\n                .get(\"http://localhost/api/productadmgetlist\", {})\n                .then((res) => {\n                  this.rows = res.data.data;\n                });\n            }\n          });\n      }\n    },\n  },\n});\n</script>"]}]}